(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{378:function(n,s,a){"use strict";a.r(s);var e=a(42),r=Object(e.a)({},(function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h3",{attrs:{id:"docker安装nginx并设置挂载目录到宿主机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker安装nginx并设置挂载目录到宿主机"}},[n._v("#")]),n._v(" Docker安装nginx并设置挂载目录到宿主机")]),n._v(" "),a("p",[n._v("查询nginx版本"),a("br"),n._v(" "),a("code",[n._v("docker search nginx")]),a("br"),n._v("\n拉取nginx1.16版本镜像"),a("br"),n._v(" "),a("code",[n._v("docker pull nginx:1.16")]),a("br"),n._v("\n启动镜像生成容器"),a("br"),n._v(" "),a("code",[n._v("docker run --name nginx-test -p 80:80 -d nginx")]),a("br"),n._v("\n创建挂载目录"),a("br"),n._v(" "),a("code",[n._v("mkdir -p /data/static /data/nginx/conf")]),a("br"),n._v("\n复制容器里的conf到宿主机。6dd4380ba708为CONTAINER ID"),a("br"),n._v(" "),a("code",[n._v("docker cp 6dd4380ba708:/etc/nginx/nginx.conf /data/nginx/conf/nginx.conf")]),a("br"),n._v("\n停止容器"),a("br"),n._v(" "),a("code",[n._v("docker stop 6dd4380ba708")]),a("br"),n._v("\n删除容器"),a("br"),n._v(" "),a("code",[n._v("docker rm 6dd4380ba708")]),a("br"),n._v("\n重新启动一个有挂载目录的镜像"),a("br"),n._v(" "),a("code",[n._v("docker run -d -p 80:80 --name visi-nginx -v /data/static:/usr/share/nginx/html -v /data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v /data/nginx/logs:/var/log/nginx nginx")])]),n._v(" "),a("blockquote",[a("p",[n._v("-p 80:80： 将容器的 80 端口映射到主机的 80 端口。"),a("br"),n._v("\n--name visi-nginx：将容器命名为 visi-nginx。"),a("br"),n._v("\n/data/static:/usr/share/nginx/html：将我们自己创建的 /data/static 目录挂载到容器的 /usr/share/nginx/html。"),a("br"),n._v("\n/data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf：将我们自己创建的 nginx.conf 挂载到容器的 /etc/nginx/nginx.conf。"),a("br"),n._v("\n/data/nginx/logs:/var/log/nginx：将我们自己创建的 logs 挂载到容器的 /var/log/nginx。")])]),n._v(" "),a("p",[n._v("打开nginx.conf"),a("br"),n._v(" "),a("code",[n._v("sudo vi /data/nginx/conf/nginx.conf")]),a("br"),n._v("\n内容如下：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('user  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n\n    log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                      \'$status $body_bytes_sent "$http_referer" \'\n                      \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    include /etc/nginx/conf.d/*.conf;\n}\n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br"),a("span",{staticClass:"line-number"},[n._v("22")]),a("br"),a("span",{staticClass:"line-number"},[n._v("23")]),a("br"),a("span",{staticClass:"line-number"},[n._v("24")]),a("br"),a("span",{staticClass:"line-number"},[n._v("25")]),a("br"),a("span",{staticClass:"line-number"},[n._v("26")]),a("br"),a("span",{staticClass:"line-number"},[n._v("27")]),a("br"),a("span",{staticClass:"line-number"},[n._v("28")]),a("br"),a("span",{staticClass:"line-number"},[n._v("29")]),a("br"),a("span",{staticClass:"line-number"},[n._v("30")]),a("br"),a("span",{staticClass:"line-number"},[n._v("31")]),a("br")])]),a("p",[n._v("在http{}里的最后面加入")]),n._v(" "),a("blockquote",[a("p",[n._v("站点目录为上面自己nginx,把所有的静态网页放到这里就可以访问了。")])]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("#下面是server虚拟主机的配置\n server\n  {\n    listen 80;#监听端口\n    server_name localhost;#域名\n    index index.html index.htm;\n    root /usr/share/nginx/html;#站点目录\n  }\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("把前端的静态文件放到/data/staic 下就可以访问了。")])])}),[],!1,null,null,null);s.default=r.exports}}]);