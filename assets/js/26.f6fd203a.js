(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{382:function(s,r,e){"use strict";e.r(r);var t=e(42),a=Object(t.a)({},(function(){var s=this,r=s.$createElement,e=s._self._c||r;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"redis6-0-5搭建集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redis6-0-5搭建集群"}},[s._v("#")]),s._v(" redis6.0.5搭建集群")]),s._v(" "),e("p",[s._v("用3台ubuntu系统")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("ip地址")]),s._v(" "),e("th",[s._v("端口")]),s._v(" "),e("th")])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("192.168.124.12")]),s._v(" "),e("td",[s._v("7000")]),s._v(" "),e("td")]),s._v(" "),e("tr",[e("td",[s._v("192.168.124.12")]),s._v(" "),e("td",[s._v("7001")]),s._v(" "),e("td")]),s._v(" "),e("tr",[e("td",[s._v("192.168.124.13")]),s._v(" "),e("td",[s._v("7002")]),s._v(" "),e("td")]),s._v(" "),e("tr",[e("td",[s._v("192.168.124.13")]),s._v(" "),e("td",[s._v("7003")]),s._v(" "),e("td")]),s._v(" "),e("tr",[e("td",[s._v("192.168.124.14")]),s._v(" "),e("td",[s._v("7004")]),s._v(" "),e("td")]),s._v(" "),e("tr",[e("td",[s._v("192.168.124.14")]),s._v(" "),e("td",[s._v("7005")]),s._v(" "),e("td")])])]),s._v(" "),e("h2",{attrs:{id:"安装redis"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装redis"}},[s._v("#")]),s._v(" 安装redis")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.redis.io/releases/redis-6.0.5.tar.gz\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzf redis-6.0.5.tar.gz\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-6.0.5\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"复制redis-6-0-5文件夹到-usr目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#复制redis-6-0-5文件夹到-usr目录"}},[s._v("#")]),s._v(" 复制redis-6.0.5文件夹到/usr目录")]),s._v(" "),e("p",[s._v("在机器1，ip为192.168.124.12的机器上复制2份redis"),e("br"),s._v(" "),e("code",[s._v("cp -r redis-6.0.5 /usr/local/redis-cluster/redis7000")]),e("br"),s._v(" "),e("code",[s._v("cp -r redis-6.0.5 /usr/local/redis-cluster/redis7001")])]),s._v(" "),e("h2",{attrs:{id:"进入到redis目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#进入到redis目录"}},[s._v("#")]),s._v(" 进入到redis目录")]),s._v(" "),e("p",[s._v("分别进入redis目录，复制一份配置文件")]),s._v(" "),e("p",[e("code",[s._v("cd /usr/local/redis-cluster/redis7000")]),e("br"),s._v(" "),e("code",[s._v("cp redis.conf redis7000.conf")])]),s._v(" "),e("p",[e("code",[s._v("cd /usr/local/redis-cluster/redis7001")]),e("br"),s._v(" "),e("code",[s._v("cp redis.conf redis7001.conf")])]),s._v(" "),e("h2",{attrs:{id:"修改配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[s._v("#")]),s._v(" 修改配置文件")]),s._v(" "),e("p",[e("code",[s._v("vim redis7000.conf")])]),s._v(" "),e("h2",{attrs:{id:"修改配置如下-每个redis的配置按照相应的更改"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改配置如下-每个redis的配置按照相应的更改"}},[s._v("#")]),s._v(" 修改配置如下,每个redis的配置按照相应的更改")]),s._v(" "),e("ol",[e("li",[s._v("注释#bind 127.0.0.1")]),s._v(" "),e("li",[s._v("修改protected-mode为no")]),s._v(" "),e("li",[s._v("port 7000 #设置启动端口")]),s._v(" "),e("li",[s._v("cluster-enabled yes #允许集群启动")]),s._v(" "),e("li",[s._v("cluster-config-file nodes7000.conf #集群配置文件名")]),s._v(" "),e("li",[s._v("cluster-node-timeout 5000 #集群节点之间多少毫秒无法连接后判定节点挂掉")]),s._v(" "),e("li",[s._v("pidfile /usr/local/redis-cluster/redis7000/redis7000.pid #修改pid文件创建位置")]),s._v(" "),e("li",[s._v("logfile /usr/local/redis-cluster/redis7000/redis7000.log #修改日志文件存储位置")]),s._v(" "),e("li",[s._v("dir /usr/local/redis-cluster/redis7000/data/ #修改数据文件存储位置")]),s._v(" "),e("li",[s._v("requirepass XX#密码")])]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"创建文件夹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建文件夹"}},[s._v("#")]),s._v(" 创建文件夹")]),s._v(" "),e("p",[s._v("每个redis服务都需要创建"),e("br"),s._v(" "),e("code",[s._v("sudo mkdir /usr/local/redis-cluster/redis7000/data/")])]),s._v(" "),e("h2",{attrs:{id:"启动6个redis服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动6个redis服务"}},[s._v("#")]),s._v(" 启动6个redis服务")]),s._v(" "),e("p",[s._v("开启7000端口的服务"),e("br"),s._v(" "),e("code",[s._v("cd /usr/local/redis-cluster/redis7000/src")]),e("br"),s._v("\n启动服务"),e("br"),s._v(" "),e("code",[s._v("./redis-server ../redis7000.conf")])]),s._v(" "),e("h2",{attrs:{id:"开启6个服务后"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开启6个服务后"}},[s._v("#")]),s._v(" 开启6个服务后")]),s._v(" "),e("p",[s._v("进入到任意一个节点  创建集群"),e("br"),s._v(" "),e("code",[s._v("cd /usr/local/redis-cluster/redis7000")]),e("br"),s._v("\n启动集群"),e("br"),s._v(" "),e("code",[s._v("src/redis-cli --cluster create 192.168.124.12:7000 192.168.124.12:7001 192.168.124.13:7002 192.168.124.13:7003 192.168.124.14:7004 192.168.124.14:7005 --cluster-replicas 1")]),e("br"),s._v("\n提示后，输入"),e("code",[s._v("yes")])]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/note/redis/cluster/cluster1.png",alt:"cluster1.png"}})]),s._v(" "),e("h2",{attrs:{id:"登录客户端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#登录客户端"}},[s._v("#")]),s._v(" 登录客户端")]),s._v(" "),e("p",[s._v("redis-cli -c -p 7000")]),s._v(" "),e("h2",{attrs:{id:"连接其他端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#连接其他端口"}},[s._v("#")]),s._v(" 连接其他端口")]),s._v(" "),e("p",[s._v("redis-cli -h 192.168.124.12 -p 7000")])])}),[],!1,null,null,null);r.default=a.exports}}]);